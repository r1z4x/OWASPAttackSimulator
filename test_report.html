<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OWASPAttackSimulator Security Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'owasp-red': '#dc2626',
                        'owasp-orange': '#ea580c',
                        'owasp-yellow': '#ca8a04',
                        'owasp-green': '#16a34a',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="w-full px-4 py-8">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">OWASPAttackSimulator Security Report</h1>
                    <p class="text-gray-600">OWASP Top 10 Attack Simulator</p>
                </div>
                <div class="text-right">
                    <p class="text-sm text-gray-500">Generated: 2025-08-28T21:03:12+03:00</p>
                    <p class="text-lg font-semibold text-gray-900">Total Findings: 1</p>
                </div>
            </div>
        </div>

        <!-- Scan Summary -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">Scan Summary</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-blue-50 rounded-lg p-4">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <svg class="h-8 w-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-blue-600">Total Requests</p>
                            <p class="text-2xl font-bold text-blue-900">1</p>
                        </div>
                    </div>
                </div>
                <div class="bg-green-50 rounded-lg p-4">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <svg class="h-8 w-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-green-600">Requests Tested</p>
                            <p class="text-2xl font-bold text-green-900">1</p>
                        </div>
                    </div>
                </div>
                <div class="bg-yellow-50 rounded-lg p-4">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <svg class="h-8 w-8 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-yellow-600">Scan Duration</p>
                            <p class="text-2xl font-bold text-yellow-900">0ms</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Category Based Analysis -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">All Requests Analysis</h2>
            <p class="text-gray-600 mb-4">Detailed analysis of all 1 requests tested during the security scan, organized by OWASP categories.</p>
            
            <!-- Filter Controls -->
            <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                <div class="flex flex-wrap items-center justify-between gap-4 mb-4">
                    <div class="flex items-center gap-4">
                        <div id="active-filters" class="flex items-center gap-2 text-sm text-gray-600 hidden">
                            <span class="font-medium">Aktif Filtreler:</span>
                            <span id="filter-summary" class="text-blue-600"></span>
                            <button onclick="clearAllFilters()" class="text-red-500 hover:text-red-700 underline ml-2">
                                Temizle
                            </button>
                        </div>
                    </div>
                    <div class="flex gap-3">
                        <button onclick="openCategoryFilterModal()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                            </svg>
                            Kategori Filtresi
                        </button>
                        <button onclick="openVariantFilterModal()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"></path>
                            </svg>
                            Varyant TÃ¼rleri Filtresi
                        </button>
                    </div>
                </div>
                

                

            </div>
            
            
            <div class="mb-8 category-section" data-category="A01:2021 - Broken Access Control">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">A01:2021 - Broken Access Control</h3>
                <p class="text-gray-600 mb-4">Total Findings: 1</p>
                
                
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b">#</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b">Timestamp</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b">Request Type</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b">Method</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b">URL</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b">Status</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b">Size (bytes)</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b">Time (ms)</th>
                                <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-b">WAF Blocked</th>
                                <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-b">Rate Limited</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            
                            <tr class="hover:bg-gray-50">
                                <td class="px-4 py-3 text-sm text-gray-900 font-mono">1</td>
                                <td class="px-4 py-3 text-sm text-gray-900 font-mono">
                                    <span class="text-xs">28/08/2025 21:03:12</span>
                                </td>
                                <td class="px-4 py-3 text-sm font-medium text-gray-900">
                                    <span class="font-mono text-sm">Security Report</span>
                                </td>
                                <td class="px-4 py-3 text-sm text-gray-900">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium 
                                        bg-blue-100 text-blue-800
                                        ">
                                        GET
                                    </span>
                                </td>
                                <td class="px-4 py-3 text-sm text-gray-900 font-mono">
                                    <div class="flex items-center space-x-2">
                                        <button onclick="showURLModal('Command-line report', 'Security Report')" 
                                                class="text-blue-600 hover:text-blue-800 hover:bg-blue-50 underline cursor-pointer truncate block max-w-xs text-left px-2 py-1 rounded border border-transparent hover:border-blue-300 transition-colors">
                                            Command-line report
                                        </button>
                                    </div>
                                </td>
                                <td class="px-4 py-3 text-sm text-gray-900">
                                    
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium 
                                            bg-green-100 text-green-800">
                                            200
                                        </span>
                                    
                                </td>
                                <td class="px-4 py-3 text-sm text-gray-900 font-mono">
                                    
                                        1.0KB
                                    
                                </td>
                                <td class="px-4 py-3 text-sm text-gray-900 font-mono">
                                    
                                        <span class="text-green-600">
                                            150ms
                                        </span>
                                    
                                </td>

                                <td class="px-4 py-3 text-sm text-gray-900 text-center">
                                    
                                        <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded hover:bg-green-200">
                                            <span class="text-center">â</span>
                                            <span class="text-center">Passed</span>
                                        </span>
                                    
                                </td>
                                <td class="px-4 py-3 text-sm text-gray-900 text-center">
                                    
                                        <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded hover:bg-green-200">
                                            <span class="text-center">â</span>
                                            <span class="text-center">Normal</span>
                                        </span>
                                    
                                </td>
                                <td class="px-4 py-3 text-sm text-gray-900 text-center">
                                    <div class="flex space-x-1 justify-center">
                                        <button data-payload="N/A" data-type="Security Report" 
                                                onclick="showPayloadModal(this.dataset.payload, this.dataset.type)" 
                                                class="text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded hover:bg-orange-200">
                                            <span class="text-center">ð¯</span>
                                            <span class="text-center">Payload</span>
                                        </button>
                                        <button data-evidence="Report generated successfully with available data" data-type="Security Report" 
                                                onclick="showEvidenceModal(this.dataset.evidence, this.dataset.type)" 
                                                class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded hover:bg-blue-200">
                                            <span class="text-center">ð</span>
                                            <span class="text-center">Evidence</span>
                                        </button>
                                        <button data-request="" data-type="Security Report" 
                                                onclick="showRequestModal(this.dataset.request, this.dataset.type)" 
                                                class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded hover:bg-green-200">
                                            <span class="text-center">ð¤</span>
                                            <span class="text-center">Request</span>
                                        </button>
                                        <button data-response="" data-type="Security Report" 
                                                onclick="showResponseModal(this.dataset.response, this.dataset.type)" 
                                                class="text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded hover:bg-purple-200">
                                            <span class="text-center">ð¥</span>
                                            <span class="text-center">Response</span>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            
                        </tbody>
                    </table>
                </div>
                
            </div>
            
            <div class="mb-8 category-section" data-category="A02:2021 - Cryptographic Failures">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">A02:2021 - Cryptographic Failures</h3>
                <p class="text-gray-600 mb-4">Total Findings: 0</p>
                
                
                <div class="text-center py-6">
                    <div class="inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-3">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-sm">No findings in this category - all tests passed successfully.</p>
                </div>
                
            </div>
            
            <div class="mb-8 category-section" data-category="A03:2021 - Injection">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">A03:2021 - Injection</h3>
                <p class="text-gray-600 mb-4">Total Findings: 0</p>
                
                
                <div class="text-center py-6">
                    <div class="inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-3">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-sm">No findings in this category - all tests passed successfully.</p>
                </div>
                
            </div>
            
            <div class="mb-8 category-section" data-category="A04:2021 - Insecure Design">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">A04:2021 - Insecure Design</h3>
                <p class="text-gray-600 mb-4">Total Findings: 0</p>
                
                
                <div class="text-center py-6">
                    <div class="inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-3">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-sm">No findings in this category - all tests passed successfully.</p>
                </div>
                
            </div>
            
            <div class="mb-8 category-section" data-category="A05:2021 - Security Misconfiguration">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">A05:2021 - Security Misconfiguration</h3>
                <p class="text-gray-600 mb-4">Total Findings: 0</p>
                
                
                <div class="text-center py-6">
                    <div class="inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-3">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-sm">No findings in this category - all tests passed successfully.</p>
                </div>
                
            </div>
            
            <div class="mb-8 category-section" data-category="A06:2021 - Vulnerable and Outdated Components">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">A06:2021 - Vulnerable and Outdated Components</h3>
                <p class="text-gray-600 mb-4">Total Findings: 0</p>
                
                
                <div class="text-center py-6">
                    <div class="inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-3">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-sm">No findings in this category - all tests passed successfully.</p>
                </div>
                
            </div>
            
            <div class="mb-8 category-section" data-category="A07:2021 - Identification and Authentication Failures">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">A07:2021 - Identification and Authentication Failures</h3>
                <p class="text-gray-600 mb-4">Total Findings: 0</p>
                
                
                <div class="text-center py-6">
                    <div class="inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-3">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-sm">No findings in this category - all tests passed successfully.</p>
                </div>
                
            </div>
            
            <div class="mb-8 category-section" data-category="A08:2021 - Software and Data Integrity Failures">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">A08:2021 - Software and Data Integrity Failures</h3>
                <p class="text-gray-600 mb-4">Total Findings: 0</p>
                
                
                <div class="text-center py-6">
                    <div class="inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-3">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-sm">No findings in this category - all tests passed successfully.</p>
                </div>
                
            </div>
            
            <div class="mb-8 category-section" data-category="A09:2021 - Security Logging and Monitoring Failures">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">A09:2021 - Security Logging and Monitoring Failures</h3>
                <p class="text-gray-600 mb-4">Total Findings: 0</p>
                
                
                <div class="text-center py-6">
                    <div class="inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-3">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-sm">No findings in this category - all tests passed successfully.</p>
                </div>
                
            </div>
            
            <div class="mb-8 category-section" data-category="A10:2021 - Server-Side Request Forgery">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">A10:2021 - Server-Side Request Forgery</h3>
                <p class="text-gray-600 mb-4">Total Findings: 0</p>
                
                
                <div class="text-center py-6">
                    <div class="inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-3">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-sm">No findings in this category - all tests passed successfully.</p>
                </div>
                
            </div>
            
        </div>

        <!-- No Findings Message -->
        
    </div>

    <!-- Payload Modal -->
    <div id="payloadModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
        <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-medium text-gray-900" id="payloadModalTitle">Payload Details</h3>
                    <button onclick="closePayloadModal()" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <pre id="modalPayload" class="whitespace-pre-wrap text-sm text-gray-700 font-mono overflow-x-auto"></pre>
                </div>
                <div class="mt-6 flex justify-end">
                    <button onclick="closePayloadModal()" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Evidence Modal -->
    <div id="evidenceModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
        <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-medium text-gray-900" id="modalTitle">Evidence Details</h3>
                    <button onclick="closeEvidenceModal()" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div class="mt-2">
                    <pre id="modalEvidence" class="bg-gray-100 p-4 rounded text-sm overflow-x-auto whitespace-pre-wrap"></pre>
                </div>
                <div class="mt-4 flex justify-end">
                    <button onclick="closeEvidenceModal()" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Request Modal -->
    <div id="requestModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
        <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-medium text-gray-900" id="requestModalTitle">Request Details</h3>
                    <button onclick="closeRequestModal()" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div class="mt-2">
                    <pre id="modalRequest" class="bg-gray-100 p-4 rounded text-sm overflow-x-auto whitespace-pre-wrap"></pre>
                </div>
                <div class="mt-4 flex justify-end">
                    <button onclick="closeRequestModal()" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Response Modal -->
    <div id="responseModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
        <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-medium text-gray-900" id="responseModalTitle">Response Details</h3>
                    <button onclick="closeResponseModal()" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div class="mt-2">
                    <pre id="modalResponse" class="bg-gray-100 p-4 rounded text-sm overflow-x-auto whitespace-pre-wrap"></pre>
                </div>
                <div class="mt-4 flex justify-end">
                    <button onclick="closeResponseModal()" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- URL Modal -->
    <div id="urlModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-[9999]">
        <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-medium text-gray-900" id="urlModalTitle">URL Details</h3>
                    <button onclick="closeURLModal()" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div class="mt-2">
                    <pre id="modalURL" class="bg-gray-100 p-4 rounded text-sm overflow-x-auto whitespace-pre-wrap"></pre>
                </div>
                <div class="mt-4 flex justify-end">
                    <button onclick="closeURLModal()" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Variant Filter Modal -->
    <div id="variantFilterModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-[9999]">
        <div class="relative top-10 mx-auto p-5 border w-11/12 md:w-4/5 lg:w-3/4 xl:w-2/3 shadow-lg rounded-md bg-white max-h-[90vh] overflow-y-auto">
            <div class="mt-3">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-medium text-gray-900">Varyant TÃ¼rleri Filtresi</h3>
                    <button onclick="closeVariantFilterModal()" class="text-gray-400 hover:text-gray-600" title="Kapat">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <!-- Search and Controls -->
                <div class="mb-6 grid grid-cols-1 lg:grid-cols-2 gap-4">
                    <!-- Search Box -->
                    <div class="relative h-fit">
                        <input type="text" id="variantSearch" placeholder="Varyant tÃ¼rÃ¼ ara..." 
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                            <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                        </div>
                    </div>

                    <!-- Select All/None Buttons -->
                    <div class="flex flex-wrap gap-2 items-center justify-end">
                        <button onclick="selectAllVariants()" class="px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700">
                            TÃ¼mÃ¼nÃ¼ SeÃ§
                        </button>
                        <button onclick="deselectAllVariants()" class="px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700">
                            HiÃ§birini SeÃ§me
                        </button>
                        <button onclick="selectOnlyTestedVariants()" class="px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700">
                            Sadece Test Edilenleri SeÃ§
                        </button>
                        <div class="text-sm text-gray-600 ml-2">
                            <span id="selected-variant-count">0</span> varyant seÃ§ildi
                        </div>
                    </div>
                </div>

                <!-- Variant Categories -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    
                    <div class="variant-category">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3 border-b pb-2">A01:2021 - Broken Access Control</h4>
                        <div class="space-y-2">
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="broken_access_control" data-category="A01:2021 - Broken Access Control">
                                <span class="text-sm text-gray-700">broken_access_control</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="idor" data-category="A01:2021 - Broken Access Control">
                                <span class="text-sm text-gray-700">idor</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="privilege_escalation" data-category="A01:2021 - Broken Access Control">
                                <span class="text-sm text-gray-700">privilege_escalation</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="jwt_manipulation" data-category="A01:2021 - Broken Access Control">
                                <span class="text-sm text-gray-700">jwt_manipulation</span>
                            </label>
                            
                        </div>
                    </div>
                    
                    <div class="variant-category">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3 border-b pb-2">A02:2021 - Cryptographic Failures</h4>
                        <div class="space-y-2">
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="weak_crypto" data-category="A02:2021 - Cryptographic Failures">
                                <span class="text-sm text-gray-700">weak_crypto</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="weak_hashing" data-category="A02:2021 - Cryptographic Failures">
                                <span class="text-sm text-gray-700">weak_hashing</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="insecure_transport" data-category="A02:2021 - Cryptographic Failures">
                                <span class="text-sm text-gray-700">insecure_transport</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="weak_randomness" data-category="A02:2021 - Cryptographic Failures">
                                <span class="text-sm text-gray-700">weak_randomness</span>
                            </label>
                            
                        </div>
                    </div>
                    
                    <div class="variant-category">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3 border-b pb-2">A03:2021 - Injection</h4>
                        <div class="space-y-2">
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="xss" data-category="A03:2021 - Injection">
                                <span class="text-sm text-gray-700">xss</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="sqli" data-category="A03:2021 - Injection">
                                <span class="text-sm text-gray-700">sqli</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="command_injection" data-category="A03:2021 - Injection">
                                <span class="text-sm text-gray-700">command_injection</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="ldap_injection" data-category="A03:2021 - Injection">
                                <span class="text-sm text-gray-700">ldap_injection</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="nosql_injection" data-category="A03:2021 - Injection">
                                <span class="text-sm text-gray-700">nosql_injection</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="header_injection" data-category="A03:2021 - Injection">
                                <span class="text-sm text-gray-700">header_injection</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="template_injection" data-category="A03:2021 - Injection">
                                <span class="text-sm text-gray-700">template_injection</span>
                            </label>
                            
                        </div>
                    </div>
                    
                    <div class="variant-category">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3 border-b pb-2">A04:2021 - Insecure Design</h4>
                        <div class="space-y-2">
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="business_logic_flaw" data-category="A04:2021 - Insecure Design">
                                <span class="text-sm text-gray-700">business_logic_flaw</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="race_condition" data-category="A04:2021 - Insecure Design">
                                <span class="text-sm text-gray-700">race_condition</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="insecure_workflow" data-category="A04:2021 - Insecure Design">
                                <span class="text-sm text-gray-700">insecure_workflow</span>
                            </label>
                            
                        </div>
                    </div>
                    
                    <div class="variant-category">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3 border-b pb-2">A05:2021 - Security Misconfiguration</h4>
                        <div class="space-y-2">
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="default_credentials" data-category="A05:2021 - Security Misconfiguration">
                                <span class="text-sm text-gray-700">default_credentials</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="debug_mode" data-category="A05:2021 - Security Misconfiguration">
                                <span class="text-sm text-gray-700">debug_mode</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="verbose_errors" data-category="A05:2021 - Security Misconfiguration">
                                <span class="text-sm text-gray-700">verbose_errors</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="missing_headers" data-category="A05:2021 - Security Misconfiguration">
                                <span class="text-sm text-gray-700">missing_headers</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="weak_cors" data-category="A05:2021 - Security Misconfiguration">
                                <span class="text-sm text-gray-700">weak_cors</span>
                            </label>
                            
                        </div>
                    </div>
                    
                    <div class="variant-category">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3 border-b pb-2">A06:2021 - Vulnerable and Outdated Components</h4>
                        <div class="space-y-2">
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="known_vulnerability" data-category="A06:2021 - Vulnerable and Outdated Components">
                                <span class="text-sm text-gray-700">known_vulnerability</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="outdated_component" data-category="A06:2021 - Vulnerable and Outdated Components">
                                <span class="text-sm text-gray-700">outdated_component</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="version_disclosure" data-category="A06:2021 - Vulnerable and Outdated Components">
                                <span class="text-sm text-gray-700">version_disclosure</span>
                            </label>
                            
                        </div>
                    </div>
                    
                    <div class="variant-category">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3 border-b pb-2">A07:2021 - Identification and Authentication Failures</h4>
                        <div class="space-y-2">
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="weak_auth" data-category="A07:2021 - Identification and Authentication Failures">
                                <span class="text-sm text-gray-700">weak_auth</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="session_fixation" data-category="A07:2021 - Identification and Authentication Failures">
                                <span class="text-sm text-gray-700">session_fixation</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="session_timeout" data-category="A07:2021 - Identification and Authentication Failures">
                                <span class="text-sm text-gray-700">session_timeout</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="weak_password" data-category="A07:2021 - Identification and Authentication Failures">
                                <span class="text-sm text-gray-700">weak_password</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="brute_force" data-category="A07:2021 - Identification and Authentication Failures">
                                <span class="text-sm text-gray-700">brute_force</span>
                            </label>
                            
                        </div>
                    </div>
                    
                    <div class="variant-category">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3 border-b pb-2">A08:2021 - Software and Data Integrity Failures</h4>
                        <div class="space-y-2">
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="insecure_deserialization" data-category="A08:2021 - Software and Data Integrity Failures">
                                <span class="text-sm text-gray-700">insecure_deserialization</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="code_injection" data-category="A08:2021 - Software and Data Integrity Failures">
                                <span class="text-sm text-gray-700">code_injection</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="supply_chain_attack" data-category="A08:2021 - Software and Data Integrity Failures">
                                <span class="text-sm text-gray-700">supply_chain_attack</span>
                            </label>
                            
                        </div>
                    </div>
                    
                    <div class="variant-category">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3 border-b pb-2">A09:2021 - Security Logging and Monitoring Failures</h4>
                        <div class="space-y-2">
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="log_injection" data-category="A09:2021 - Security Logging and Monitoring Failures">
                                <span class="text-sm text-gray-700">log_injection</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="log_bypass" data-category="A09:2021 - Security Logging and Monitoring Failures">
                                <span class="text-sm text-gray-700">log_bypass</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="audit_trail_tampering" data-category="A09:2021 - Security Logging and Monitoring Failures">
                                <span class="text-sm text-gray-700">audit_trail_tampering</span>
                            </label>
                            
                        </div>
                    </div>
                    
                    <div class="variant-category">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3 border-b pb-2">A10:2021 - Server-Side Request Forgery</h4>
                        <div class="space-y-2">
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="ssrf" data-category="A10:2021 - Server-Side Request Forgery">
                                <span class="text-sm text-gray-700">ssrf</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="xxe" data-category="A10:2021 - Server-Side Request Forgery">
                                <span class="text-sm text-gray-700">xxe</span>
                            </label>
                            
                            <label class="flex items-center variant-item">
                                <input type="checkbox" class="variant-filter mr-3" data-variant="open_redirect" data-category="A10:2021 - Server-Side Request Forgery">
                                <span class="text-sm text-gray-700">open_redirect</span>
                            </label>
                            
                        </div>
                    </div>
                    
                </div>


            </div>
        </div>
    </div>

    <!-- Category Filter Modal -->
    <div id="categoryFilterModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-[9999]">
        <div class="relative top-10 mx-auto p-5 border w-11/12 md:w-4/5 lg:w-3/4 xl:w-2/3 shadow-lg rounded-md bg-white max-h-[90vh] overflow-y-auto">
            <div class="mt-3">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-medium text-gray-900">Kategori Filtresi</h3>
                    <button onclick="closeCategoryFilterModal()" class="text-gray-400 hover:text-gray-600" title="Kapat">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <!-- Search and Controls -->
                <div class="mb-6 grid grid-cols-1 lg:grid-cols-2 gap-4">
                    <!-- Search Box -->
                    <div class="relative h-fit">
                        <input type="text" id="categorySearch" placeholder="Kategori ara..." 
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                            <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                        </div>
                    </div>

                    <!-- Select All/None Buttons -->
                    <div class="flex flex-wrap gap-2 items-center justify-end">
                        <button onclick="selectAllCategories()" class="px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700">
                            TÃ¼mÃ¼nÃ¼ SeÃ§
                        </button>
                        <button onclick="deselectAllCategories()" class="px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700">
                            HiÃ§birini SeÃ§me
                        </button>
                        <button onclick="selectOnlyTestedCategories()" class="px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700">
                            Sadece Test Edilenleri SeÃ§
                        </button>
                        <div class="text-sm text-gray-600 ml-2">
                            <span id="selected-category-count">0</span> kategori seÃ§ildi
                        </div>
                    </div>
                </div>

                <!-- Category List -->
                <div class="space-y-3">
                    <label class="flex items-center category-item">
                        <input type="checkbox" id="filter-all" class="category-filter mr-3" checked>
                        <span class="text-sm font-medium text-gray-700">TÃ¼m Kategoriler</span>
                    </label>
                    <label class="flex items-center category-item">
                        <input type="checkbox" id="filter-a01" class="category-filter mr-3" data-category="A01:2021 - Broken Access Control">
                        <span class="text-sm font-medium text-gray-700">A01:2021 - Broken Access Control</span>
                    </label>
                    <label class="flex items-center category-item">
                        <input type="checkbox" id="filter-a02" class="category-filter mr-3" data-category="A02:2021 - Cryptographic Failures">
                        <span class="text-sm font-medium text-gray-700">A02:2021 - Cryptographic Failures</span>
                    </label>
                    <label class="flex items-center category-item">
                        <input type="checkbox" id="filter-a03" class="category-filter mr-3" data-category="A03:2021 - Injection">
                        <span class="text-sm font-medium text-gray-700">A03:2021 - Injection</span>
                    </label>
                    <label class="flex items-center category-item">
                        <input type="checkbox" id="filter-a04" class="category-filter mr-3" data-category="A04:2021 - Insecure Design">
                        <span class="text-sm font-medium text-gray-700">A04:2021 - Insecure Design</span>
                    </label>
                    <label class="flex items-center category-item">
                        <input type="checkbox" id="filter-a05" class="category-filter mr-3" data-category="A05:2021 - Security Misconfiguration">
                        <span class="text-sm font-medium text-gray-700">A05:2021 - Security Misconfiguration</span>
                    </label>
                    <label class="flex items-center category-item">
                        <input type="checkbox" id="filter-a06" class="category-filter mr-3" data-category="A06:2021 - Vulnerable and Outdated Components">
                        <span class="text-sm font-medium text-gray-700">A06:2021 - Vulnerable and Outdated Components</span>
                    </label>
                    <label class="flex items-center category-item">
                        <input type="checkbox" id="filter-a07" class="category-filter mr-3" data-category="A07:2021 - Identification and Authentication Failures">
                        <span class="text-sm font-medium text-gray-700">A07:2021 - Identification and Authentication Failures</span>
                    </label>
                    <label class="flex items-center category-item">
                        <input type="checkbox" id="filter-a08" class="category-filter mr-3" data-category="A08:2021 - Software and Data Integrity Failures">
                        <span class="text-sm font-medium text-gray-700">A08:2021 - Software and Data Integrity Failures</span>
                    </label>
                    <label class="flex items-center category-item">
                        <input type="checkbox" id="filter-a09" class="category-filter mr-3" data-category="A09:2021 - Security Logging and Monitoring Failures">
                        <span class="text-sm font-medium text-gray-700">A09:2021 - Security Logging and Monitoring Failures</span>
                    </label>
                    <label class="flex items-center category-item">
                        <input type="checkbox" id="filter-a10" class="category-filter mr-3" data-category="A10:2021 - Server-Side Request Forgery">
                        <span class="text-sm font-medium text-gray-700">A10:2021 - Server-Side Request Forgery</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showPayloadModal(payload, vulnerabilityType) {
            if (payload && vulnerabilityType) {
                document.getElementById('modalPayload').textContent = payload;
                document.getElementById('payloadModalTitle').textContent = 'Payload - ' + vulnerabilityType;
                document.getElementById('payloadModal').classList.remove('hidden');
            }
        }

        function closePayloadModal() {
            document.getElementById('payloadModal').classList.add('hidden');
        }

        function showEvidenceModal(evidence, vulnerabilityType) {
            if (evidence && vulnerabilityType) {
                document.getElementById('modalEvidence').textContent = evidence;
                document.getElementById('modalTitle').textContent = 'Evidence - ' + vulnerabilityType;
                document.getElementById('evidenceModal').classList.remove('hidden');
            }
        }

        function closeEvidenceModal() {
            document.getElementById('evidenceModal').classList.add('hidden');
        }

        function showRequestModal(requestData, vulnerabilityType) {
            if (requestData && vulnerabilityType) {
                document.getElementById('modalRequest').textContent = requestData;
                document.getElementById('requestModalTitle').textContent = 'Request - ' + vulnerabilityType;
                document.getElementById('requestModal').classList.remove('hidden');
            }
        }

        function closeRequestModal() {
            document.getElementById('requestModal').classList.add('hidden');
        }

        function showResponseModal(responseData, vulnerabilityType) {
            if (responseData && vulnerabilityType) {
                document.getElementById('modalResponse').textContent = responseData;
                document.getElementById('responseModalTitle').textContent = 'Response - ' + vulnerabilityType;
                document.getElementById('responseModal').classList.remove('hidden');
            }
        }

        function closeResponseModal() {
            document.getElementById('responseModal').classList.add('hidden');
        }

        function showURLModal(url, vulnerabilityType) {
            console.log('showURLModal called with:', { url, vulnerabilityType });
            
            // Check if elements exist
            const modalElement = document.getElementById('urlModal');
            const modalURLElement = document.getElementById('modalURL');
            const modalTitleElement = document.getElementById('urlModalTitle');
            
            console.log('Modal elements:', { 
                modalElement: !!modalElement, 
                modalURLElement: !!modalURLElement, 
                modalTitleElement: !!modalTitleElement 
            });
            
            if (url && vulnerabilityType && modalElement && modalURLElement && modalTitleElement) {
                console.log('Setting modal content...');
                modalURLElement.textContent = url;
                modalTitleElement.textContent = 'URL - ' + vulnerabilityType;
                modalElement.classList.remove('hidden');
                console.log('URL modal should be visible now');
            } else {
                console.log('Missing data or elements:', { 
                    url: !!url, 
                    vulnerabilityType: !!vulnerabilityType,
                    modalElement: !!modalElement,
                    modalURLElement: !!modalURLElement,
                    modalTitleElement: !!modalTitleElement
                });
            }
        }

        function closeURLModal() {
            document.getElementById('urlModal').classList.add('hidden');
        }

        // Close modals when clicking outside
        document.getElementById('payloadModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closePayloadModal();
            }
        });

        document.getElementById('evidenceModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeEvidenceModal();
            }
        });

        document.getElementById('requestModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeRequestModal();
            }
        });

        document.getElementById('responseModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeResponseModal();
            }
        });

        document.getElementById('urlModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeURLModal();
            }
        });

        document.getElementById('variantFilterModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeVariantFilterModal();
            }
        });

        document.getElementById('categoryFilterModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeCategoryFilterModal();
            }
        });

        // Close modals with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closePayloadModal();
                closeEvidenceModal();
                closeRequestModal();
                closeResponseModal();
                closeURLModal();
                closeVariantFilterModal();
                closeCategoryFilterModal();
            }
        });

        // Variant filtering functionality
        let selectedVariants = new Set();
        let availableVariants = new Set();
        
        // Category filtering functionality
        let selectedCategories = new Set();
        let availableCategories = new Set();

        // Initialize available variants from the data
        function initializeAvailableVariants() {
            const rows = document.querySelectorAll('tbody tr');
            rows.forEach(row => {
                const variantCell = row.querySelector('td:nth-child(3) span');
                if (variantCell) {
                    availableVariants.add(variantCell.textContent.trim());
                }
            });
        }

        // Variant filter modal functions
        function openVariantFilterModal() {
            document.getElementById('variantFilterModal').classList.remove('hidden');
            updateSelectedVariantCount();
            initializeAvailableVariants();
        }

        function closeVariantFilterModal() {
            document.getElementById('variantFilterModal').classList.add('hidden');
        }

        function selectAllVariants() {
            const checkboxes = document.querySelectorAll('.variant-filter');
            checkboxes.forEach(checkbox => {
                checkbox.checked = true;
            });
            updateSelectedVariantCount();
            applyVariantFilters(); // Apply filtering immediately
        }

        function deselectAllVariants() {
            const checkboxes = document.querySelectorAll('.variant-filter');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            updateSelectedVariantCount();
            applyVariantFilters(); // Apply filtering immediately
        }

        function selectOnlyTestedVariants() {
            // First deselect all
            deselectAllVariants();
            
            // Then select only the ones that are available in the data
            const checkboxes = document.querySelectorAll('.variant-filter');
            checkboxes.forEach(checkbox => {
                const variant = checkbox.dataset.variant;
                if (availableVariants.has(variant)) {
                    checkbox.checked = true;
                }
            });
            updateSelectedVariantCount();
            applyVariantFilters(); // Apply filtering immediately
        }

        function updateSelectedVariantCount() {
            const checkboxes = document.querySelectorAll('.variant-filter:checked');
            const count = checkboxes.length;
            document.getElementById('selected-variant-count').textContent = count;
        }

        function applyVariantFilters() {
            selectedVariants.clear();
            const checkboxes = document.querySelectorAll('.variant-filter:checked');
            checkboxes.forEach(checkbox => {
                selectedVariants.add(checkbox.dataset.variant);
            });

            // Update the display of active filters
            updateActiveFiltersDisplay();
            
            // Apply the filtering
            applyVariantFiltering();
        }

        function updateActiveFiltersDisplay() {
            const activeFiltersDiv = document.getElementById('active-filters');
            const filterSummaryDiv = document.getElementById('filter-summary');
            
            const variantCount = selectedVariants.size;
            // Count categories excluding 'all' and empty values
            const categoryCount = Array.from(selectedCategories).filter(cat => cat !== 'all' && cat !== '').length;
            
            console.log('Debug - selectedCategories:', Array.from(selectedCategories));
            console.log('Debug - categoryCount:', categoryCount);
            console.log('Debug - variantCount:', variantCount);
            
            if (variantCount === 0 && categoryCount === 0) {
                activeFiltersDiv.classList.add('hidden');
                return;
            }

            activeFiltersDiv.classList.remove('hidden');
            
            let summary = [];
            if (variantCount > 0) {
                summary.push(variantCount + ' varyant');
            }
            if (categoryCount > 0) {
                summary.push(categoryCount + ' kategori');
            }
            
            filterSummaryDiv.textContent = summary.join(', ');
        }

        function removeVariantFilter(variant) {
            selectedVariants.delete(variant);
            
            // Uncheck the corresponding checkbox in the modal
            const checkbox = document.querySelector('.variant-filter[data-variant="' + variant + '"]');
            if (checkbox) {
                checkbox.checked = false;
            }
            
            updateActiveFiltersDisplay();
            applyVariantFilters(); // Use the main function
        }

        function clearAllVariantFilters() {
            selectedVariants.clear();
            
            // Uncheck all checkboxes in the modal
            const checkboxes = document.querySelectorAll('.variant-filter');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            
            updateActiveFiltersDisplay();
            applyVariantFilters(); // Use the main function
        }

        function clearAllFilters() {
            // Clear variant filters
            selectedVariants.clear();
            const variantCheckboxes = document.querySelectorAll('.variant-filter');
            variantCheckboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            
            // Clear category filters
            selectedCategories.clear();
            const categoryCheckboxes = document.querySelectorAll('.category-filter');
            categoryCheckboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            
            // Check "All Categories" by default
            const filterAllCheckbox = document.getElementById('filter-all');
            if (filterAllCheckbox) {
                filterAllCheckbox.checked = true;
            }
            
            updateActiveFiltersDisplay();
            applyCombinedFiltering();
        }

        function applyVariantFiltering() {
            // Use combined filtering instead
            applyCombinedFiltering();
        }

        // Search functionality for variant filter modal
        function setupVariantSearch() {
            const searchInput = document.getElementById('variantSearch');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    const variantItems = document.querySelectorAll('.variant-item');
                    
                    variantItems.forEach(item => {
                        const variantText = item.querySelector('span').textContent.toLowerCase();
                        if (variantText.includes(searchTerm)) {
                            item.style.display = '';
                        } else {
                            item.style.display = 'none';
                        }
                    });
                });
            }
        }

        // Search functionality for category filter modal
        function setupCategorySearch() {
            const searchInput = document.getElementById('categorySearch');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    const categoryItems = document.querySelectorAll('.category-item');
                    
                    categoryItems.forEach(item => {
                        const categoryText = item.querySelector('span').textContent.toLowerCase();
                        if (categoryText.includes(searchTerm)) {
                            item.style.display = '';
                        } else {
                            item.style.display = 'none';
                        }
                    });
                });
            }
        }

        // Update variant count and apply filtering when checkboxes change
        document.addEventListener('change', function(e) {
            if (e.target.classList.contains('variant-filter')) {
                updateSelectedVariantCount();
                applyVariantFilters(); // Apply filtering immediately when checkbox changes
            }
            if (e.target.classList.contains('category-filter')) {
                updateSelectedCategoryCount();
                applyCategoryFilters(); // Apply filtering immediately when checkbox changes
            }
        });

        // Initialize search functionality when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            setupVariantSearch();
            setupCategorySearch();
            initializeAvailableCategories();
        });

        // Initialize available categories from the data
        function initializeAvailableCategories() {
            const sections = document.querySelectorAll('.category-section');
            sections.forEach(section => {
                const category = section.dataset.category;
                if (category) {
                    availableCategories.add(category);
                }
            });
        }

        // Category filter modal functions
        function openCategoryFilterModal() {
            document.getElementById('categoryFilterModal').classList.remove('hidden');
            updateSelectedCategoryCount();
        }

        function closeCategoryFilterModal() {
            document.getElementById('categoryFilterModal').classList.add('hidden');
        }

        function selectAllCategories() {
            const checkboxes = document.querySelectorAll('.category-filter');
            checkboxes.forEach(checkbox => {
                checkbox.checked = true;
            });
            updateSelectedCategoryCount();
            applyCategoryFilters(); // Apply filtering immediately
        }

        function deselectAllCategories() {
            const checkboxes = document.querySelectorAll('.category-filter');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            updateSelectedCategoryCount();
            applyCategoryFilters(); // Apply filtering immediately
        }

        function selectOnlyTestedCategories() {
            // First deselect all
            deselectAllCategories();
            
            // Then select only the ones that are available in the data
            const checkboxes = document.querySelectorAll('.category-filter');
            checkboxes.forEach(checkbox => {
                const category = checkbox.dataset.category;
                if (availableCategories.has(category)) {
                    checkbox.checked = true;
                }
            });
            updateSelectedCategoryCount();
            applyCategoryFilters(); // Apply filtering immediately
        }

        function updateSelectedCategoryCount() {
            const checkboxes = document.querySelectorAll('.category-filter:checked');
            const count = checkboxes.length;
            document.getElementById('selected-category-count').textContent = count;
        }

        function applyCategoryFilters() {
            selectedCategories.clear();
            const checkboxes = document.querySelectorAll('.category-filter:checked');
            checkboxes.forEach(checkbox => {
                if (checkbox.id === 'filter-all') {
                    selectedCategories.add('all');
                } else {
                    selectedCategories.add(checkbox.dataset.category);
                }
            });

            // Update the display of active filters
            updateActiveFiltersDisplay();
            
            // Apply the filtering
            applyCombinedFiltering();
        }

        function applyCombinedFiltering() {
            const sections = document.querySelectorAll('.category-section');
            
            sections.forEach(section => {
                const category = section.dataset.category;
                const rows = section.querySelectorAll('tbody tr');
                
                // Check if category should be shown
                let showCategory = selectedCategories.has('all') || selectedCategories.has(category);
                
                if (showCategory) {
                    section.style.display = 'block';
                    
                    // Apply variant filtering to rows within this category
                    rows.forEach(row => {
                        const variantCell = row.querySelector('td:nth-child(3) span');
                        if (variantCell) {
                            const variant = variantCell.textContent.trim();
                            
                            // Check if any selected variant matches this row's variant
                            let shouldShow = selectedVariants.size === 0; // Show all if no variant filters
                            
                            if (selectedVariants.size > 0) {
                                // Check if this variant matches any selected variant
                                for (let selectedVariant of selectedVariants) {
                                    if (variant.toLowerCase().includes(selectedVariant.toLowerCase()) || 
                                        selectedVariant.toLowerCase().includes(variant.toLowerCase())) {
                                        shouldShow = true;
                                        break;
                                    }
                                }
                            }
                            
                            row.style.display = shouldShow ? '' : 'none';
                        }
                    });
                } else {
                    section.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>